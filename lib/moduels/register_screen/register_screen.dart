import 'package:flutter/material.dart';import 'package:flutter_bloc/flutter_bloc.dart';import 'package:shop_app/layout/shop_app_layout.dart';import 'package:shop_app/moduels/shop_login_screen/shop_login_screen.dart';import 'package:shop_app/shared/constant.dart';import 'package:shop_app/shared/cubit/cubit.dart';import 'package:shop_app/shared/cubit/state.dart';import 'package:shop_app/shared/network/local/shared_prefercne.dart';import 'package:shop_app/shared/style/colors.dart';class RegisterScreen extends StatelessWidget {  var emailController = TextEditingController();  var passwordController = TextEditingController();  var phoneController = TextEditingController();  var nameController = TextEditingController();  var formKay = GlobalKey<FormState>();  @override  Widget build(BuildContext context) {    return BlocProvider(      create: (context) => ShopCubit(),      child: BlocConsumer<ShopCubit, ShopStates>(        listener: (context, state) {          if (state is ShopRegisterSuccessState) {            if (state.userRegisterModel.status == true) {              print(state.userRegisterModel.message);              print(state.userRegisterModel.data!.token);              CasheHelper.putData(                      key: 'token', value: state.userRegisterModel.data!.token)                  .then((value) {                token = state.userRegisterModel.data!.token!;                Navigator.pushAndRemoveUntil(                  context,                  MaterialPageRoute(                      builder: (context) => ShopAppLayoutScreen()),                  (route) => false,                );                flutterToast(                  message: state.userRegisterModel.message.toString(),                  state: ToastState.SUCCESS,                );              });            } else {              print(state.userRegisterModel.message);              flutterToast(                message: state.userRegisterModel.message.toString(),                state: ToastState.ERROR,              );            }          }        },        builder: (context, state) {          var cubit = ShopCubit.get(context);          return Scaffold(            appBar: AppBar(),            body: Center(              child: SingleChildScrollView(                child: Padding(                  padding: const EdgeInsets.all(20.0),                  child: Form(                    key: formKay,                    child: Column(                      crossAxisAlignment: CrossAxisAlignment.start,                      children: [                        Text(                          'Welcome Back ',                          style: TextStyle(                            fontSize: 30.0,                            fontWeight: FontWeight.bold,                            color: defaultColor,                          ),                        ),                        SizedBox(                          height: 10.0,                        ),                        Text(                          'Register Now To Browse Our Hot Offer ',                          style: TextStyle(                            fontSize: 20.0,                            color: Colors.grey,                          ),                        ),                        SizedBox(                          height: 20.0,                        ),                        TextFormField(                          keyboardType: TextInputType.text,                          controller: nameController,                          validator: (String? value) {                            if (value!.isEmpty) {                              return 'please enter you name';                            }                          },                          decoration: InputDecoration(                            prefixIcon: Icon(                              Icons.person,                            ),                            border: OutlineInputBorder(                              borderRadius: BorderRadius.circular(                                20.0,                              ),                            ),                            labelText: 'User Name',                          ),                        ),                        SizedBox(                          height: 20.0,                        ),                        TextFormField(                          keyboardType: TextInputType.emailAddress,                          controller: emailController,                          validator: (String? value) {                            if (value!.isEmpty) {                              return 'please enter you email';                            }                          },                          decoration: InputDecoration(                            prefixIcon: Icon(                              Icons.email_outlined,                            ),                            border: OutlineInputBorder(                              borderRadius: BorderRadius.circular(                                20.0,                              ),                            ),                            labelText: 'Email Address',                          ),                        ),                        SizedBox(                          height: 20.0,                        ),                        TextFormField(                          onFieldSubmitted: (value) {                            if (formKay.currentState!.validate()) {                              ShopCubit.get(context).userRegister(                                email: emailController.text,                                password: passwordController.text,                                phone: phoneController.text,                                name: nameController.text,                              );                            }                          },                          obscureText: cubit.obs,                          controller: passwordController,                          validator: (String? value) {                            if (value!.isEmpty) {                              return 'please enter you password';                            }                          },                          decoration: InputDecoration(                            prefixIcon: Icon(                              Icons.lock_outline,                            ),                            suffixIcon: IconButton(                              onPressed: () {                                cubit.changePasswordVisibility();                              },                              icon: Icon(                                cubit.suffixIcon,                              ),                            ),                            border: OutlineInputBorder(                              borderRadius: BorderRadius.circular(                                20.0,                              ),                            ),                            labelText: 'Password',                          ),                        ),                        SizedBox(                          height: 20.0,                        ),                        TextFormField(                          keyboardType: TextInputType.phone,                          controller: phoneController,                          validator: (String? value) {                            if (value!.isEmpty) {                              return 'please enter you phone';                            }                          },                          decoration: InputDecoration(                            prefixIcon: Icon(                              Icons.phone,                            ),                            border: OutlineInputBorder(                              borderRadius: BorderRadius.circular(                                20.0,                              ),                            ),                            labelText: 'Phone',                          ),                        ),                        SizedBox(                          height: 20.0,                        ),                        state is! ShopRegisterLoadingState                            ? Container(                                width: double.infinity,                                height: 50.0,                                decoration: BoxDecoration(                                  color: Colors.blue,                                  borderRadius: BorderRadius.circular(                                    60.0,                                  ),                                ),                                child: MaterialButton(                                  onPressed: () {                                    if (formKay.currentState!.validate()) {                                      ShopCubit.get(context).userRegister(                                        email: emailController.text,                                        password: passwordController.text,                                        phone: phoneController.text,                                        name: nameController.text,                                      );                                    }                                  },                                  elevation: 20.0,                                  child: Text(                                    'REGISTER',                                    style: TextStyle(                                      fontSize: 20.0,                                      color: Colors.white,                                    ),                                  ),                                ),                              )                            : Center(child: CircularProgressIndicator()),                      ],                    ),                  ),                ),              ),            ),          );        },      ),    );  }}